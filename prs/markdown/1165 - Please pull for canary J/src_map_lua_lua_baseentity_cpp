@@ -38,6 +38,7 @@
 #include "../ability.h"
 #include "../alliance.h"
 #include "../battlefield.h"
+#include "../daily_system.h"
 #include "../enmity_container.h"
 #include "../guild.h"
 #include "../instance.h"
@@ -50,6 +51,7 @@
 #include "../mobskill.h"
 #include "../mob_spell_container.h"
 #include "../recast_container.h"
+#include "../roe.h"
 #include "../spell.h"
 #include "../status_effect_container.h"
 #include "../timetriggers.h"
@@ -73,12 +75,16 @@
 #include "../ai/states/weaponskill_state.h"
 
 #include "../ai/controllers/mob_controller.h"
+#include "../ai/controllers/trust_controller.h"
+
+#include "../ai/helpers/gambits_container.h"
 
 #include "../entities/automatonentity.h"
 #include "../entities/charentity.h"
 #include "../entities/mobentity.h"
 #include "../entities/npcentity.h"
 #include "../entities/petentity.h"
+#include "../entities/trustentity.h"
 
 #include "../packets/action.h"
 #include "../packets/auction_house.h"
@@ -120,6 +126,7 @@
 #include "../packets/menu_merit.h"
 #include "../packets/menu_raisetractor.h"
 #include "../packets/message_basic.h"
+#include "../packets/message_combat.h"
 #include "../packets/message_name.h"
 #include "../packets/message_special.h"
 #include "../packets/message_standard.h"
@@ -129,6 +136,7 @@
 #include "../packets/position.h"
 #include "../packets/quest_mission_log.h"
 #include "../packets/release.h"
+#include "../packets/roe_questlog.h"
 #include "../packets/server_ip.h"
 #include "../packets/shop_items.h"
 #include "../packets/shop_menu.h"
@@ -144,6 +152,7 @@
 #include "../utils/mobutils.h"
 #include "../utils/petutils.h"
 #include "../utils/puppetutils.h"
+#include "../utils/trustutils.h"
 #include "../utils/zoneutils.h"
 
 CLuaBaseEntity::CLuaBaseEntity(lua_State* L)
@@ -531,6 +540,39 @@ inline int32 CLuaBaseEntity::messageSystem(lua_State* L)
     return 0;
 }
 
+/************************************************************************
+*  Function: messageCombat(...)
+*  Purpose : Various combat related messages are ended with this packet
+*  Example : master:messageCombat(mob, offset + id, 0, 711)
+*  Notes   :
+************************************************************************/
+int32 CLuaBaseEntity::messageCombat(lua_State* L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC);
+
+    CCharEntity* PChar = (CCharEntity*)m_PBaseEntity;
+
+    CBaseEntity* PSpeaker;
+    if (!lua_isnil(L, 1) && lua_isuserdata(L, 1))
+    {
+        CLuaBaseEntity* PLuaBaseEntity = Lunar<CLuaBaseEntity>::check(L, 1);
+        PSpeaker = PLuaBaseEntity->m_PBaseEntity;
+    }
+    else
+    {
+        PSpeaker = m_PBaseEntity;
+    }
+
+    auto p0 = (int32)lua_tointeger(L, 2);
+    auto p1 = (int32)lua_tointeger(L, 3);
+    auto message = (int16)lua_tointeger(L, 4);
+
+    PChar->pushPacket(new CMessageCombatPacket(PSpeaker, PChar, p0, p1, message));
+
+    return 0;
+}
+
 /************************************************************************
 *  Function: getCharVar()
 *  Purpose : Returns a var value assigned to a PC (in char_vars.sql)
@@ -2348,15 +2390,18 @@ inline int32 CLuaBaseEntity::sendGuild(lua_State* L)
     TPZ_DEBUG_BREAK_IF(open > close);
 
     uint8 VanadielHour = (uint8)CVanaTime::getInstance()->getHour();
-    uint8 VanadielDay = (uint8)CVanaTime::getInstance()->getWeekday();
+    // uint8 VanadielDay = (uint8)CVanaTime::getInstance()->getWeekday();
 
     GUILDSTATUS status = GUILD_OPEN;
 
+    /*
+     * No more guild holidays since 2014
     if (VanadielDay == holiday)
     {
         status = GUILD_HOLYDAY;
     }
-    else if ((VanadielHour < open) || (VanadielHour >= close))
+    */
+    if ((VanadielHour < open) || (VanadielHour >= close))
     {
         status = GUILD_CLOSE;
     }
@@ -3887,7 +3932,9 @@ inline int32 CLuaBaseEntity::createShop(lua_State *L)
 /************************************************************************
 *  Function: addShopItem()
 *  Purpose : Adds an item and established price to an existing shop
-*  Example : addShopItem(512,8000)
+*          : Optionally accepts a GuildID + Guild Rank requirement
+*  Example : addShopItem(512, 8000)                                                   --Regular item
+*          : addShopItem(512, 8000, tpz.skill.CLOTHCRAFT, tpz.craftRank.JOURNEYMAN)   --Guild-rank locked item
 *  Notes   : Use with createShop() - 16 Max Items in Shop
 ************************************************************************/
 
@@ -3896,11 +3943,11 @@ inline int32 CLuaBaseEntity::addShopItem(lua_State *L)
     TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
     TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC);
 
-    TPZ_DEBUG_BREAK_IF(lua_isnil(L, -1) || !lua_isnumber(L, -1));
-    TPZ_DEBUG_BREAK_IF(lua_isnil(L, -2) || !lua_isnumber(L, -2));
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 1) || !lua_isnumber(L, 1));
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 2) || !lua_isnumber(L, 2));
 
-    uint16 itemID = (uint16)lua_tonumber(L, -2);
-    uint32 price = (uint32)lua_tonumber(L, -1);
+    uint16 itemID = (uint16)lua_tonumber(L, 1);
+    uint32 price = (uint32)lua_tonumber(L, 2);
 
     CCharEntity* PChar = (CCharEntity*)m_PBaseEntity;
     uint8 slotID = PChar->Container->getItemsCount();
@@ -3911,6 +3958,14 @@ inline int32 CLuaBaseEntity::addShopItem(lua_State *L)
     // so track the shop's number of items separately from the container's size.
     PChar->Container->setExSize(PChar->Container->getExSize() + 1);
 
+    if(lua_isnumber(L, 3) && lua_isnumber(L, 4))
+    {
+        uint8 guildID = (uint8)lua_tonumber(L, 3);
+        uint16 guildRank = (uint16)lua_tonumber(L, 4);
+
+        ((CCharEntity*)m_PBaseEntity)->Container->setGuildID(slotID, guildID);
+        ((CCharEntity*)m_PBaseEntity)->Container->setGuildRank(slotID, guildRank);
+    }
     return 0;
 }
 
@@ -5016,6 +5071,22 @@ inline int32 CLuaBaseEntity::setCampaignAllegiance(lua_State *L)
     return 0;
 }
 
+/************************************************************************
+*  Function: isSeekingParty()
+*  Purpose : Returns true if a player is seeking a party
+*  Example : if player:isSeekingParty() then
+*  Notes   :
+************************************************************************/
+
+inline int32 CLuaBaseEntity::isSeekingParty(lua_State* L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC);
+
+    lua_pushboolean(L, (((CCharEntity*)m_PBaseEntity)->nameflags.flags & FLAG_INVITE));
+    return 1;
+}
+
 /************************************************************************
 *  Function: getNewPlayer()
 *  Purpose : Returns true if a player is new
@@ -5286,6 +5357,24 @@ inline int32 CLuaBaseEntity::getPlaytime(lua_State *L)
     return 1;
 }
 
+/************************************************************************
+*  Function: getTimeCreated()
+*  Purpose : Get unix timestamp of when character was created
+*  Example : player:getTimeCreated()
+*  Notes   :
+************************************************************************/
+
+inline int32 CLuaBaseEntity::getTimeCreated(lua_State *L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC);
+
+    CCharEntity* PChar = (CCharEntity*)m_PBaseEntity;
+
+    lua_pushinteger(L, PChar->GetTimeCreated());
+    return 1;
+}
+
 /************************************************************************
 *  Function: getMainJob()
 *  Purpose : Returns the integer value of the entity's main job
@@ -5732,6 +5821,28 @@ inline int32 CLuaBaseEntity::levelRestriction(lua_State* L)
     return 1;
 }
 
+/************************************************************************
+*  Function: addJobTraits
+*  Purpose : Add job traits
+*  Example : player:addJobTraits(tpz.job.WHM, 75)
+************************************************************************/
+
+int32 CLuaBaseEntity::addJobTraits(lua_State* L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 1) || !lua_isnumber(L, 1));
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 2) || !lua_isnumber(L, 2));
+
+    CBattleEntity* PEntity = dynamic_cast<CBattleEntity*>(m_PBaseEntity);
+
+    if (PEntity != nullptr)
+    {
+        battleutils::AddTraits(PEntity, traits::GetTraits((uint8)lua_tointeger(L, 1)), (uint8)lua_tointeger(L, 2));
+    }
+
+    return 0;
+}
+
 /************************************************************************
 *  Function: getTitle()
 *  Purpose : Returns the integer value of the player's current title
@@ -6731,6 +6842,147 @@ inline int32 CLuaBaseEntity::getMissionLogEx(lua_State *L)
     return 1;
 }
 
+/************************************************************************
+*  Function: setEminenceCompleted()
+*  Purpose :
+*  Example : player:setEminenceCompleted(1)
+*  Notes   : optional arg 1 flags for repeat record (1/0) (Does not remove from log)
+*            optional arg 2 can set completion state explicitly (1/0)
+************************************************************************/
+
+inline int32 CLuaBaseEntity::setEminenceCompleted(lua_State *L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC);
+
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 1) || !lua_isnumber(L, 1));
+
+    CCharEntity* PChar = (CCharEntity*)m_PBaseEntity;
+    uint16 recordID = (uint16)lua_tointeger(L, 1);
+
+    bool repeat = false;
+    if (lua_gettop(L) > 1)
+    {
+        repeat = lua_tointeger(L, 2) != 0;
+    }
+
+    bool status = true;
+    if (lua_gettop(L) > 2)
+    {
+        status = lua_tointeger(L, 3) != 0;
+    }
+
+    if (repeat)
+    {
+        roeutils::SetEminenceRecordProgress(PChar, recordID, 0);
+    }
+    else
+    {
+        roeutils::DelEminenceRecord(PChar, recordID);
+    }
+
+    roeutils::SetEminenceRecordCompletion(PChar, recordID, status);
+
+    return 0;
+}
+
+/************************************************************************
+*  Function: getEminenceCompleted()
+*  Purpose : Returns true if eminence is flagged complete for player
+*  Example : player:getEminenceCompleted(1)
+*  Notes   :
+************************************************************************/
+
+inline int32 CLuaBaseEntity::getEminenceCompleted(lua_State *L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC);
+
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 1) || !lua_isnumber(L, 1));
+
+    CCharEntity* PChar = (CCharEntity*)m_PBaseEntity;
+    uint16 recordID = (uint16)lua_tointeger(L, 1);
+
+    lua_pushboolean(L, (bool)roeutils::GetEminenceRecordCompletion(PChar, recordID));
+
+    return 1;
+}
+
+/************************************************************************
+*  Function: setEminenceProgress(record, progress, total)
+*  Purpose :
+*  Example : player:setEminenceProgress(12, 3, 200)
+*  Notes   : The 3rd param is optional. However, no message will be shown if not given.
+************************************************************************/
+
+inline int32 CLuaBaseEntity::setEminenceProgress(lua_State *L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC);
+
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 1) || !lua_isnumber(L, 1));
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 2) || !lua_isnumber(L, 2));
+
+    CCharEntity* PChar = (CCharEntity*)m_PBaseEntity;
+    uint16 recordID = static_cast<uint16>(lua_tointeger(L, 1));
+    uint32 progress = static_cast<uint32>(lua_tointeger(L, 2));
+    uint32 total = static_cast<uint32>(lua_tointeger(L, 3));
+
+    // Determine threshold for sending progress messages
+    bool progressNotify {true};
+    if (uint32 threshold = roeutils::RoeCache.NotifyThresholds[recordID]; threshold > 1)
+    {
+        uint32 prevStep = static_cast<uint32>(roeutils::GetEminenceRecordProgress(PChar, recordID) / threshold);
+        uint32 nextStep = static_cast<uint32>(progress / threshold);
+        progressNotify = nextStep > prevStep;
+    }
+
+    bool result = roeutils::SetEminenceRecordProgress(PChar, recordID, progress);
+    lua_pushboolean(L, result);
+
+    if (total && progressNotify)
+    {
+        PChar->pushPacket(new CMessageBasicPacket(PChar, PChar, recordID, 0, MSGBASIC_ROE_RECORD));
+        PChar->pushPacket(new CMessageBasicPacket(PChar, PChar, progress, total, MSGBASIC_ROE_PROGRESS));
+    }
+
+    return 1;
+}
+
+/************************************************************************
+*  Function: getEminenceProgress(record)
+*  Purpose :
+*  Example : player:getEminenceProgress(19)
+*  Notes   : returns nil if player does not have the record.
+************************************************************************/
+
+inline int32 CLuaBaseEntity::getEminenceProgress(lua_State *L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC);
+
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 1) || !lua_isnumber(L, 1));
+
+    if(m_PBaseEntity->objtype != TYPE_PC)
+    {
+        lua_pushnil(L);
+        return 1;
+    }
+
+    CCharEntity* PChar = (CCharEntity*)m_PBaseEntity;
+    uint16 recordID = (uint16)lua_tointeger(L, 1);
+
+    if(roeutils::HasEminenceRecord(PChar, recordID))
+    {
+        uint32 progress = roeutils::GetEminenceRecordProgress(PChar, recordID);
+        lua_pushinteger(L, progress);
+    } else {
+        lua_pushnil(L);
+    }
+
+    return 1;
+}
+
 /************************************************************************
 *  Function: addAssault()
 *  Purpose : Adds an assault mission to the player's log
@@ -8746,10 +8998,50 @@ inline int32 CLuaBaseEntity::getParty(lua_State* L)
     return 1;
 }
 
+/************************************************************************
+*  Function: getPartyWithTrusts()
+*  Purpose : Returns a Lua table of party member and trust Entity objects
+*  Example : local party = player:getPartyWithTrusts()
+*  Notes   :
+************************************************************************/
+
+inline int32 CLuaBaseEntity::getPartyWithTrusts(lua_State* L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC);
+
+    CParty* party = ((CCharEntity*)m_PBaseEntity)->PParty;
+
+    int size = 0;
+    if (party)
+    {
+        size = party->MemberCount(m_PBaseEntity->getZone());
+    }
+    else
+    {
+        size = 1;
+    }
+
+    lua_createtable(L, size, 0);
+    int i = 1;
+    ((CCharEntity*)m_PBaseEntity)->ForPartyWithTrusts([&L, &i](CBattleEntity* member)
+    {
+        lua_getglobal(L, CLuaBaseEntity::className);
+        lua_pushstring(L, "new");
+        lua_gettable(L, -2);
+        lua_insert(L, -2);
+        lua_pushlightuserdata(L, (void*)member);
+        lua_pcall(L, 2, 1, 0);
+
+        lua_rawseti(L, -2, i++);
+    });
+
+    return 1;
+}
+
 /************************************************************************
 *  Function: getPartySize()
 *  Purpose : Returns the count of members in the party
-*  Example : local count = getPartySize()
+*  Example : local count = player:getPartySize()
 *  Notes   :
 ************************************************************************/
 
@@ -8758,9 +9050,7 @@ inline int32 CLuaBaseEntity::getPartySize(lua_State* L)
     TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
     TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype == TYPE_NPC);
 
-    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 1) || !lua_isnumber(L, 1));
-
-    uint8 allianceparty = (uint8)lua_tonumber(L, 1);
+    uint8 allianceparty = lua_isnil(L, 1) ? 0 : (uint8)lua_tonumber(L, 1);
     uint8 partysize = 1;
 
     if (((CBattleEntity*)m_PBaseEntity)->PParty != nullptr)
@@ -8800,6 +9090,14 @@ inline int32 CLuaBaseEntity::hasPartyJob(lua_State *L)
                 lua_pushboolean(L, true);
                 return 1;
             }
+            for (auto PTrust : PTarget->PTrusts)
+            {
+                if (PTrust->GetMJob() == job)
+                {
+                    lua_pushboolean(L, true);
+                    return 1;
+                }
+            }
         }
     }
     lua_pushboolean(L, false);
@@ -9114,6 +9412,30 @@ inline int32 CLuaBaseEntity::getLeaderID(lua_State* L)
     return 1;
 }
 
+/************************************************************************
+*  Function: getPartyLastMemberJoinedTime()
+*  Purpose : Get the epoch time point in seconds that the last PC joined the party (if any)
+*  Example : seconds_since_last_member_joined = os.time() - player:getPartyLastMemberJoinedTime()
+*  Notes   :
+************************************************************************/
+
+int32 CLuaBaseEntity::getPartyLastMemberJoinedTime(lua_State* L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC);
+
+    CCharEntity* PChar = ((CCharEntity*)m_PBaseEntity);
+
+    if (PChar->PParty != nullptr)
+    {
+        lua_pushnumber(L, PChar->PParty->GetTimeLastMemberJoined());
+        return 1;
+    }
+
+    lua_pushnumber(L, 0);
+    return 1;
+}
+
 /************************************************************************
 *  Function: reloadParty()
 *  Purpose : Display a new party in the event of alliance form/disband
@@ -9154,6 +9476,27 @@ inline int32 CLuaBaseEntity::disableLevelSync(lua_State* L)
     return 0;
 }
 
+/************************************************************************
+*  Function: isLevelSync()
+*  Purpose :
+*  Example : player:isLevelSync()
+*  Notes   :
+************************************************************************/
+
+inline int32 CLuaBaseEntity::isLevelSync(lua_State* L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC);
+
+    CCharEntity* PChar = (CCharEntity*)m_PBaseEntity;
+
+    if (PChar->PParty)
+        lua_pushboolean(L, (PChar->PParty->GetSyncTarget() && PChar->PParty->GetSyncTarget() != PChar) );
+    else
+        lua_pushboolean(L, false);
+
+    return 1;
+}
+
 /************************************************************************
 *  Function: checkSoloPartyAlliance()
 *  Purpose : Checks if Entity is solo, in a party, or in an alliance
@@ -10515,11 +10858,11 @@ inline int32 CLuaBaseEntity::updateEnmityFromCure(lua_State *L)
     CLuaBaseEntity* PEntity = Lunar<CLuaBaseEntity>::check(L, 1);
     auto amount = (int32)lua_tointeger(L, 2);
 
-    auto PCurer = [&]() -> CCharEntity*
+    auto PCurer = [&]() -> CBattleEntity*
     {
-        if (m_PBaseEntity->objtype == TYPE_PC)
+        if (m_PBaseEntity->objtype == TYPE_PC || m_PBaseEntity->objtype == TYPE_TRUST)
         {
-            return static_cast<CCharEntity*>(m_PBaseEntity);
+            return static_cast<CBattleEntity*>(m_PBaseEntity);
         }
         else if (m_PBaseEntity->objtype == TYPE_PET && static_cast<CPetEntity*>(m_PBaseEntity)->getPetType() != PETTYPE_AUTOMATON)
         {
@@ -10597,6 +10940,49 @@ inline int32 CLuaBaseEntity::updateClaim(lua_State *L)
     return 0;
 }
 
+/************************************************************************
+*  Function: hasEnmity()
+*  Purpose : Find out if an entity has any enmity from any mob nearby
+*  Example : player::hasEnmity()
+*  Notes   :
+************************************************************************/
+
+inline int32 CLuaBaseEntity::hasEnmity(lua_State* L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC && m_PBaseEntity->objtype != TYPE_PET && m_PBaseEntity->objtype != TYPE_TRUST);
+
+    SpawnIDList_t* mobList{};
+    if (m_PBaseEntity->objtype == TYPE_PC)
+    {
+        mobList = &static_cast<CCharEntity*>(m_PBaseEntity)->SpawnMOBList;
+    }
+    else if (m_PBaseEntity->objtype == TYPE_PET)
+    {
+        auto trust = static_cast<CPetEntity*>(m_PBaseEntity);
+        mobList = &static_cast<CCharEntity*>(trust->PMaster)->SpawnMOBList;
+    }
+    else if (m_PBaseEntity->objtype == TYPE_TRUST)
+    {
+        auto trust = static_cast<CTrustEntity*>(m_PBaseEntity);
+        mobList = &static_cast<CCharEntity*>(trust->PMaster)->SpawnMOBList;
+    }
+
+    bool hasEnmity = false;
+    for (SpawnIDList_t::const_iterator it = mobList->begin(); it != mobList->end(); ++it)
+    {
+        auto* mob = static_cast<CMobEntity*>(it->second);
+        if (mob->PEnmityContainer->HasID(m_PBaseEntity->id))
+        {
+            hasEnmity = true;
+            break;
+        }
+    }
+
+    lua_pushboolean(L, hasEnmity);
+    return 1;
+}
+
 /************************************************************************
 *  Function: addStatusEffect(effect, power, tick, duration)
 *  Purpose : Adds a specified Status Effect to the Entity
@@ -11976,7 +12362,7 @@ int32 CLuaBaseEntity::removeAmmo(lua_State* L)
 inline int32 CLuaBaseEntity::getWeaponSkillLevel(lua_State *L)
 {
     TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
-    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC && m_PBaseEntity->objtype != TYPE_PET && m_PBaseEntity->objtype != TYPE_MOB);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype == TYPE_NPC);
 
     TPZ_DEBUG_BREAK_IF(lua_isnil(L, 1) || !lua_isnumber(L, 1));
 
@@ -12270,7 +12656,7 @@ inline int32 CLuaBaseEntity::spawnTrust(lua_State *L)
     if (!lua_isnil(L, 1) && lua_isstring(L, 1))
     {
         uint16 trustId = (uint16)lua_tointeger(L, 1);
-        petutils::SpawnTrust((CCharEntity*)m_PBaseEntity, trustId);
+        trustutils::SpawnTrust((CCharEntity*)m_PBaseEntity, trustId);
     }
     else
     {
@@ -12279,6 +12665,335 @@ inline int32 CLuaBaseEntity::spawnTrust(lua_State *L)
     return 0;
 }
 
+/************************************************************************
+*  Function: clearTrusts()
+*  Purpose :
+*  Example : caster:clearTrusts()
+*  Notes   :
+************************************************************************/
+
+inline int32 CLuaBaseEntity::clearTrusts(lua_State* L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_PC); // only PCs can spawn trusts
+
+    static_cast<CCharEntity*>(m_PBaseEntity)->ClearTrusts();
+
+    return 0;
+}
+
+/************************************************************************
+*  Function: getTrustID()
+*  Purpose :
+*  Example : trust:getTrustID()
+*  Notes   :
+************************************************************************/
+
+inline int32 CLuaBaseEntity::getTrustID(lua_State* L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_TRUST);
+
+    lua_pushinteger(L, ((CTrustEntity*)m_PBaseEntity)->m_TrustID);
+    return 1;
+}
+
+/************************************************************************
+*  Function: trustPartyMessage()
+*  Purpose :
+*  Example : mob:trustPartyMessage(message_id)
+*  Notes   :
+************************************************************************/
+
+inline int32 CLuaBaseEntity::trustPartyMessage(lua_State* L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_TRUST);
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 1) || !lua_isnumber(L, 1));
+
+    auto PTrust = static_cast<CTrustEntity*>(m_PBaseEntity);
+
+    auto message_id = (uint32)lua_tointeger(L, 1);
+
+    auto PMaster = static_cast<CCharEntity*>(PTrust->PMaster);
+    if (PMaster)
+    {
+        PMaster->ForParty([&](CBattleEntity* PMember)
+            {
+                auto PCharMember = static_cast<CCharEntity*>(PMember);
+                PCharMember->pushPacket(new CMessageCombatPacket(PTrust, PMember, message_id, 0, 711));
+            });
+    }
+
+    return 0;
+}
+
+/************************************************************************
+*  Function: addSimpleGambit()
+*  Purpose :
+*  Example : trust:addSimpleGambit(target, condition, condition_arg, reaction, selector, selector_arg)
+*  Notes   : Adds a behaviour to the gambit system
+************************************************************************/
+
+inline int32 CLuaBaseEntity::addSimpleGambit(lua_State* L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_TRUST);
+
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 1) || !lua_isnumber(L, 1));
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 2) || !lua_isnumber(L, 2));
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 3) || !lua_isnumber(L, 3));
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 4) || !lua_isnumber(L, 4));
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 5) || !lua_isnumber(L, 5));
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 6) || !lua_isnumber(L, 6));
+
+    using namespace gambits;
+
+    auto target = static_cast<G_TARGET>(lua_tointeger(L, 1));
+    auto condition = static_cast<G_CONDITION>(lua_tointeger(L, 2));
+    auto condition_arg = static_cast<uint32>(lua_tointeger(L, 3));
+
+    auto reaction = static_cast<G_REACTION>(lua_tointeger(L, 4));
+    auto selector = static_cast<G_SELECT>(lua_tointeger(L, 5));
+    auto selector_arg = static_cast<uint32>(lua_tointeger(L, 6));
+
+    // Optional
+    auto retry_delay = 0;
+    if (!lua_isnil(L, 7) && lua_isnumber(L, 7))
+    {
+        retry_delay = (uint16)lua_tointeger(L, 7);
+    }
+
+    Gambit_t g;
+    g.predicates.emplace_back(Predicate_t{ target, condition, condition_arg });
+    g.actions.emplace_back(Action_t{ reaction, selector, selector_arg });
+    g.retry_delay = retry_delay;
+
+    auto trust = static_cast<CTrustEntity*>(m_PBaseEntity);
+    auto controller = static_cast<CTrustController*>(trust->PAI->GetController());
+
+    controller->m_GambitsContainer->AddGambit(g);
+
+    return 0;
+}
+
+/************************************************************************
+*  Function: addFullGambit()
+*  Purpose :
+*  Example : mob:addGambit(...)
+*  Notes   : Adds a behaviour to the gambit system
+************************************************************************/
+
+inline int32 CLuaBaseEntity::addFullGambit(lua_State* L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_TRUST);
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 1) || !lua_istable(L, 1));
+
+    using namespace gambits;
+
+    // ===
+
+    Gambit_t g;
+
+    bool gambit_error = false;
+
+    lua_pushvalue(L, 1); // Push main table onto stack
+
+    lua_getfield(L, 1, "predicates"); // Acts as push
+    if (lua_istable(L, -1)) // Found
+    {
+        auto table = lua_gettop(L);
+        lua_pushnil(L);
+        while (lua_next(L, table) != 0)
+        {
+            Predicate_t new_predicate;
+            auto sub_table = lua_gettop(L);
+            lua_pushnil(L);
+            while (lua_next(L, sub_table) != 0)
+            {
+                auto key = std::string(lua_tostring(L, -2));
+                auto value = static_cast<uint32>(lua_tonumber(L, -1));
+                lua_pop(L, 1);
+
+                if (!new_predicate.parseInput(key, value))
+                {
+                    gambit_error = true;
+                }
+            }
+            g.predicates.emplace_back(new_predicate);
+            lua_pop(L, 1);
+        }
+        lua_pop(L, 1);
+    }
+    else // No predicates block found!
+    {
+        gambit_error = true;
+    }
+
+    lua_getfield(L, 1, "actions");
+    if (lua_istable(L, -1))
+    {
+        auto table = lua_gettop(L);
+        lua_pushnil(L);
+        while (lua_next(L, table) != 0)
+        {
+            Action_t new_action;
+            auto sub_table = lua_gettop(L);
+            lua_pushnil(L);
+            while (lua_next(L, sub_table) != 0)
+            {
+                auto key = std::string(lua_tostring(L, -2));
+                auto value = static_cast<uint32>(lua_tonumber(L, -1));
+                lua_pop(L, 1);
+
+                if (!new_action.parseInput(key, (uint32)value))
+                {
+                    gambit_error = true;
+                }
+            }
+            g.actions.emplace_back(new_action);
+            lua_pop(L, 1);
+        }
+        lua_pop(L, 1);
+    }
+    else // No actions block found!
+    {
+        gambit_error = true;
+    }
+
+    lua_pop(L, 1);
+
+    lua_pop(L, 1); // Main table
+
+    if (gambit_error)
+    {
+        ShowWarning("Invalid Gambit");
+    }
+
+    // ===
+
+    auto trust = static_cast<CTrustEntity*>(m_PBaseEntity);
+    auto controller = static_cast<CTrustController*>(trust->PAI->GetController());
+
+    controller->m_GambitsContainer->AddGambit(g);
+
+    return 0;
+}
+
+/************************************************************************
+*  Function: setTPSkills()
+*  Purpose :
+*  Example : mob:setTPSkills(...)
+*  Notes   :
+************************************************************************/
+
+int32 CLuaBaseEntity::setTPSkills(lua_State* L)
+{
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_TRUST);
+    TPZ_DEBUG_BREAK_IF(lua_isnil(L, 1) || !lua_istable(L, 1));
+
+    auto trust = static_cast<CTrustEntity*>(m_PBaseEntity);
+    auto controller = static_cast<CTrustController*>(trust->PAI->GetController());
+    auto mLvl = trust->GetMLevel();
+
+    using namespace gambits;
+
+    // TODO: This is all garbage and arcane, can be done better!
+
+    std::vector<uint32> skills_data;
+
+    // skills
+    lua_getfield(L, 1, "skills");
+    if (lua_istable(L, -1))
+    {
+        auto table = lua_gettop(L);
+        lua_pushnil(L);
+        while (lua_next(L, table) != 0)
+        {
+            auto sub_table = lua_gettop(L);
+            lua_pushnil(L);
+            while (lua_next(L, sub_table) != 0)
+            {
+                auto value = static_cast<uint32>(lua_tonumber(L, -1));
+                skills_data.emplace_back(value);
+                lua_pop(L, 1);
+            }
+            lua_pop(L, 1);
+        }
+    }
+    else
+    {
+        // No skills, fatal!
+    }
+    lua_pop(L, 1);
+
+    // Handle skills_data
+    for (size_t i = 0; i < skills_data.size(); i += 3)
+    {
+        auto skill_type = skills_data[i];
+        auto skill_id = skills_data[i + 1];
+        auto min_level = skills_data[i + 2];
+
+        TrustSkill_t skill{ static_cast<G_REACTION>(skill_type), skill_id, min_level };
+        if (skill.skill_type == G_REACTION::WS)
+        {
+            CWeaponSkill* PWeaponSkill = battleutils::GetWeaponSkill(skill_id);
+            if (!PWeaponSkill)
+            {
+                ShowWarning("CLuaBaseEntity::setTPSkills: Error loading WeaponSkill id %d for trust %s\n", skill_id, trust->name);
+                break;
+            }
+            skill.primary = PWeaponSkill->getPrimarySkillchain();
+            skill.secondary = PWeaponSkill->getSecondarySkillchain();
+            skill.tertiary = PWeaponSkill->getTertiarySkillchain();
+        }
+        else // MS
+        {
+            CMobSkill* PMobSkill = battleutils::GetMobSkill(skill_id);
+            if (!PMobSkill)
+            {
+                ShowWarning("CLuaBaseEntity::setTPSkills: Error loading MobSkill id %d for trust %s\n", skill_id, trust->name);
+                break;
+            }
+            skill.primary = PMobSkill->getPrimarySkillchain();
+            skill.secondary = PMobSkill->getSecondarySkillchain();
+            skill.tertiary = PMobSkill->getTertiarySkillchain();
+        }
+
+        if (mLvl >= min_level)
+        {
+            controller->m_GambitsContainer->tp_skills.emplace_back(skill);
+        }
+     }
+
+    // mode
+    uint32 mode = 0;
+    lua_getfield(L, 1, "mode");
+    if (lua_isnumber(L, -1))
+    {
+        mode = static_cast<uint32>(lua_tonumber(L, -1));
+    }
+    lua_pop(L, 1);
+
+    // skill_select
+    uint32 skill_select = 0;
+    lua_getfield(L, 1, "skill_select");
+    if (lua_isnumber(L, -1))
+    {
+        skill_select = static_cast<uint32>(lua_tonumber(L, -1));
+    }
+    lua_pop(L, 1);
+
+    lua_pop(L, 1); // Init state
+
+    controller->m_GambitsContainer->tp_trigger = static_cast<G_TP_TRIGGER>(mode);
+    controller->m_GambitsContainer->tp_select = static_cast<G_SELECT>(skill_select);
+
+    return 0;
+}
+
 /************************************************************************
 *  Function: despawnPet()
 *  Purpose : Despawns a Pet Entity
@@ -12444,20 +13159,19 @@ inline int32 CLuaBaseEntity::getMaster(lua_State* L)
     TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
     TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype == TYPE_NPC)
 
-        if (((CBattleEntity*)m_PBaseEntity)->PMaster != nullptr)
-        {
-            //uint32 petid = (uint32);
+    if (((CBattleEntity*)m_PBaseEntity)->PMaster != nullptr)
+    {
+        CBaseEntity* PMaster = ((CBattleEntity*)m_PBaseEntity)->PMaster;
 
-            CBaseEntity* PMaster = ((CBattleEntity*)m_PBaseEntity)->PMaster;
+        lua_getglobal(L, CLuaBaseEntity::className);
+        lua_pushstring(L, "new");
+        lua_gettable(L, -2);
+        lua_insert(L, -2);
+        lua_pushlightuserdata(L, (void*)PMaster);
+        lua_pcall(L, 2, 1, 0);
+        return 1;
+    }
 
-            lua_getglobal(L, CLuaBaseEntity::className);
-            lua_pushstring(L, "new");
-            lua_gettable(L, -2);
-            lua_insert(L, -2);
-            lua_pushlightuserdata(L, (void*)PMaster);
-            lua_pcall(L, 2, 1, 0);
-            return 1;
-        }
     lua_pushnil(L);
     return 1;
 }
@@ -14000,7 +14714,7 @@ inline int32 CLuaBaseEntity::useJobAbility(lua_State* L)
 inline int32 CLuaBaseEntity::useMobAbility(lua_State* L)
 {
     TPZ_DEBUG_BREAK_IF(m_PBaseEntity == nullptr);
-    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_MOB && m_PBaseEntity->objtype != TYPE_PET);
+    TPZ_DEBUG_BREAK_IF(m_PBaseEntity->objtype != TYPE_TRUST && m_PBaseEntity->objtype != TYPE_MOB && m_PBaseEntity->objtype != TYPE_PET);
 
     if (lua_isnumber(L, 1))
     {
@@ -14350,658 +15064,676 @@ const char CLuaBaseEntity::className[] = "CBaseEntity";
 
 Lunar<CLuaBaseEntity>::Register_t CLuaBaseEntity::methods[] =
 {
-
     // Messaging System
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,showText),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,messageText),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,PrintToPlayer),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,PrintToArea),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,messageBasic),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,messageName),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,messagePublic),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,messageSpecial),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,messageSystem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, showText),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, messageText),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, PrintToPlayer),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, PrintToArea),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, messageBasic),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, messageName),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, messagePublic),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, messageSpecial),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, messageSystem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, messageCombat),
 
     // Variables
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getCharVar),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setCharVar),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addCharVar),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getLocalVar),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setLocalVar),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,resetLocalVars),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getCharVar),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setCharVar),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addCharVar),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getLocalVar),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setLocalVar),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, resetLocalVars),
 
     // Masks and Bitwise Operations
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMaskBit),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setMaskBit),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,countMaskBits),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isMaskFull),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMaskBit),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setMaskBit),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, countMaskBits),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isMaskFull),
 
     // Packets, Events, and Flags
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,injectPacket),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,injectActionPacket),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,entityVisualPacket),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,entityAnimationPacket),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,startEvent),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,startEventString),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,updateEvent),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,updateEventString),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getEventTarget),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,release),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setFlag),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,moghouseFlag),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,needToZone),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, injectPacket),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, injectActionPacket),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, entityVisualPacket),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, entityAnimationPacket),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, startEvent),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, startEventString),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, updateEvent),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, updateEventString),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getEventTarget),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, release),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setFlag),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, moghouseFlag),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, needToZone),
 
     // Object Identification
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getID),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getShortID),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getCursorTarget),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getID),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getShortID),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getCursorTarget),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getObjType),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isPC),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isNPC),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isMob),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isPet),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isAlly),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getObjType),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isPC),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isNPC),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isMob),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isPet),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isAlly),
 
     // AI and Control
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,initNpcAi),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,resetAI),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getStatus),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setStatus),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getCurrentAction),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,lookAt),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,clearTargID),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,atPoint),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,pathTo),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,pathThrough),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isFollowingPath),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,clearPath),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,checkDistance),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,wait),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,openDoor),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,closeDoor),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setElevator),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addPeriodicTrigger),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,showNPC),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hideNPC),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,updateNPCHideTime),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getWeather),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setWeather),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, initNpcAi),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, resetAI),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getStatus),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setStatus),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getCurrentAction),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, lookAt),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, clearTargID),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, atPoint),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, pathTo),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, pathThrough),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isFollowingPath),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, clearPath),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, checkDistance),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, wait),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, openDoor),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, closeDoor),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setElevator),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addPeriodicTrigger),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, showNPC),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hideNPC),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, updateNPCHideTime),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getWeather),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setWeather),
 
     // PC Instructions
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,ChangeMusic),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,sendMenu),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,sendGuild),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,openSendBox),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,leavegame),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,sendEmote),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, ChangeMusic),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, sendMenu),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, sendGuild),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, openSendBox),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, leavegame),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, sendEmote),
 
     // Location and Positioning
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isBehind),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isFacing),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getAngle),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getZone),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getZoneID),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getZoneName),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isZoneVisited),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getPreviousZone),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getCurrentRegion),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getContinentID),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isInMogHouse),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getPos),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,showPosition),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getXPos),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getYPos),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getZPos),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getRotPos),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setPos),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,warp),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,teleport),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addTeleport),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getTeleport),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasTeleport),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setTeleportMenu),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getTeleportMenu),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setHomePoint),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,resetPlayer),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,goToEntity),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,gotoPlayer),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,bringPlayer),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isBehind),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isFacing),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getAngle),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getZone),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getZoneID),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getZoneName),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isZoneVisited),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPreviousZone),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getCurrentRegion),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getContinentID),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isInMogHouse),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPos),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, showPosition),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getXPos),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getYPos),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getZPos),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getRotPos),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setPos),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, warp),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, teleport),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addTeleport),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getTeleport),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasTeleport),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setTeleportMenu),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getTeleportMenu),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setHomePoint),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, resetPlayer),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, goToEntity),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, gotoPlayer),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, bringPlayer),
 
     // Items
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getEquipID),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getEquippedItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addUsedItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addTempItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasWornItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,createWornItem),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,createShop),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addShopItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getCurrentGPItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,breakLinkshell),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getEquipID),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getEquippedItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addUsedItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addTempItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasWornItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, createWornItem),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, createShop),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addShopItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getCurrentGPItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, breakLinkshell),
 
     // Trading
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getContainerSize),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,changeContainerSize),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getFreeSlotsCount),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,confirmTrade),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,tradeComplete),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getContainerSize),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, changeContainerSize),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getFreeSlotsCount),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, confirmTrade),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, tradeComplete),
 
     // Equipping
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,canEquipItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,equipItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,unequipItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, canEquipItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, equipItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, unequipItem),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setEquipBlock),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,lockEquipSlot),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,unlockEquipSlot),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setEquipBlock),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, lockEquipSlot),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, unlockEquipSlot),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getShieldSize),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getShieldSize),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasGearSetMod),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addGearSetMod),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,clearGearSetMods),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasGearSetMod),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addGearSetMod),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, clearGearSetMods),
 
     // Storing
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getStorageItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,storeWithPorterMoogle),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getRetrievableItemsForSlip),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,retrieveItemFromSlip),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getStorageItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, storeWithPorterMoogle),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getRetrievableItemsForSlip),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, retrieveItemFromSlip),
 
     // Player Appearance
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getRace),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getGender),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getName),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hideName),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,checkNameFlags),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getModelId),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setModelId),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,costume),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,costume2),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getAnimation),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setAnimation),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,AnimationSub),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getRace),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getGender),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getName),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hideName),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, checkNameFlags),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getModelId),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setModelId),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, costume),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, costume2),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getAnimation),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setAnimation),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, AnimationSub),
 
     // Player Status
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getNation),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setNation),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getAllegiance),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setAllegiance),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getCampaignAllegiance),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setCampaignAllegiance),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getNation),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setNation),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getAllegiance),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setAllegiance),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getCampaignAllegiance),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setCampaignAllegiance),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getNewPlayer),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setNewPlayer),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMentor),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setMentor),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isSeekingParty),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getNewPlayer),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setNewPlayer),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMentor),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setMentor),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getGMLevel),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setGMLevel),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getGMHidden),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setGMHidden),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getGMLevel),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setGMLevel),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getGMHidden),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setGMHidden),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isJailed),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,jail),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isJailed),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, jail),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,canUseMisc),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, canUseMisc),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,speed),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, speed),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getPlaytime),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPlaytime),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getTimeCreated),
 
     // Player Jobs and Levels
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMainJob),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getSubJob),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,changeJob),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,changesJob),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,unlockJob),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasJob),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMainLvl),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getSubLvl),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getJobLevel),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setLevel),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setsLevel),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,levelCap),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,levelRestriction),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMainJob),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getSubJob),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, changeJob),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, changesJob),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, unlockJob),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasJob),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMainLvl),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getSubLvl),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getJobLevel),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setLevel),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setsLevel),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, levelCap),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, levelRestriction),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addJobTraits),
 
     // Player Titles and Fame
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getTitle),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasTitle),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addTitle),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setTitle),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delTitle),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getFame),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addFame),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setFame),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getFameLevel),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getRank),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setRank),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getRankPoints),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addRankPoints),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setRankPoints),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addQuest),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delQuest),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getQuestStatus),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasCompletedQuest),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,completeQuest),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addMission),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delMission),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getCurrentMission),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasCompletedMission),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,completeMission),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setMissionLogEx),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMissionLogEx),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addAssault),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delAssault),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getCurrentAssault),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasCompletedAssault),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,completeAssault),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addKeyItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delKeyItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasKeyItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,seenKeyItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,unseenKeyItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getTitle),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasTitle),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addTitle),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setTitle),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delTitle),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getFame),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addFame),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setFame),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getFameLevel),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getRank),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setRank),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getRankPoints),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addRankPoints),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setRankPoints),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addQuest),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delQuest),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getQuestStatus),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasCompletedQuest),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, completeQuest),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addMission),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delMission),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getCurrentMission),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasCompletedMission),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, completeMission),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setMissionLogEx),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMissionLogEx),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getEminenceCompleted),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setEminenceCompleted),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getEminenceProgress),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setEminenceProgress),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addAssault),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delAssault),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getCurrentAssault),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasCompletedAssault),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, completeAssault),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addKeyItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delKeyItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasKeyItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, seenKeyItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, unseenKeyItem),
 
     // Player Points
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addExp),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delExp),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMerit),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMeritCount),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setMerits),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addExp),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delExp),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMerit),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMeritCount),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setMerits),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getGil),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addGil),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setGil),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delGil),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getGil),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addGil),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setGil),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delGil),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getCP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addCP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delCP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getCP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addCP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delCP),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getSeals),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addSeals),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delSeals),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getSeals),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addSeals),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delSeals),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getCurrency),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addCurrency),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setCurrency),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delCurrency),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getCurrency),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addCurrency),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setCurrency),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delCurrency),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getAssaultPoint),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addAssaultPoint),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delAssaultPoint),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getAssaultPoint),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addAssaultPoint),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delAssaultPoint),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addGuildPoints),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addGuildPoints),
 
     // Health and Status
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getHP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getHPP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMaxHP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getBaseHP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addHP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setHP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,restoreHP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delHP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,takeDamage),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hideHP),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getHP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getHPP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMaxHP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getBaseHP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addHP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setHP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, restoreHP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delHP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, takeDamage),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hideHP),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMP),
     // Got an MPP? Well, I then you don't know me...
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMaxMP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getBaseMP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addMP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setMP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,restoreMP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delMP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMaxMP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getBaseMP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addMP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setMP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, restoreMP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delMP),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getTP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addTP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setTP),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delTP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getTP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addTP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setTP),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delTP),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,updateHealth),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, updateHealth),
 
     // Skills and Abilities
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,capSkill),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,capAllSkills),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, capSkill),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, capAllSkills),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getSkillLevel),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setSkillLevel),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMaxSkillLevel),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getSkillRank),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setSkillRank),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getCharSkillLevel),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getSkillLevel),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setSkillLevel),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMaxSkillLevel),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getSkillRank),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setSkillRank),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getCharSkillLevel),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addLearnedWeaponskill),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasLearnedWeaponskill),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delLearnedWeaponskill),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addLearnedWeaponskill),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasLearnedWeaponskill),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delLearnedWeaponskill),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addWeaponSkillPoints),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addWeaponSkillPoints),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addLearnedAbility),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasLearnedAbility),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,canLearnAbility),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delLearnedAbility),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addLearnedAbility),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasLearnedAbility),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, canLearnAbility),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delLearnedAbility),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addSpell),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasSpell),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,canLearnSpell),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delSpell),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addSpell),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasSpell),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, canLearnSpell),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delSpell),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,recalculateSkillsTable),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,recalculateAbilitiesTable),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, recalculateSkillsTable),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, recalculateAbilitiesTable),
 
     // Parties and Alliances
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getParty),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getPartySize),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasPartyJob),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getPartyMember),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getPartyLeader),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getLeaderID),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,forMembersInRange),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addPartyEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasPartyEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,removePartyEffect),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getAlliance),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getAllianceSize),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,reloadParty),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,disableLevelSync),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,checkSoloPartyAlliance),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,checkKillCredit),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getParty),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPartyWithTrusts),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPartySize),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasPartyJob),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPartyMember),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPartyLeader),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getLeaderID),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPartyLastMemberJoinedTime),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, forMembersInRange),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addPartyEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasPartyEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, removePartyEffect),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getAlliance),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getAllianceSize),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, reloadParty),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, disableLevelSync),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isLevelSync),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, checkSoloPartyAlliance),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, checkKillCredit),
 
     // Instances
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getInstance),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setInstance),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,createInstance),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,instanceEntry),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getInstance),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setInstance),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, createInstance),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, instanceEntry),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getConfrontationEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,copyConfrontationEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getConfrontationEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, copyConfrontationEffect),
 
     // Battlefields
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getBattlefield),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getBattlefieldID),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,registerBattlefield),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,battlefieldAtCapacity),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,enterBattlefield),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,leaveBattlefield),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isInDynamis),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getBattlefield),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getBattlefieldID),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, registerBattlefield),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, battlefieldAtCapacity),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, enterBattlefield),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, leaveBattlefield),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isInDynamis),
 
     // Battle Utilities
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isAlive),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isDead),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isAlive),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isDead),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,sendRaise),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,sendReraise),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,sendTractor),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, sendRaise),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, sendReraise),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, sendTractor),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,countdown),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,enableEntities),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,independantAnimation),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, messageCombat),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, countdown),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, enableEntities),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, independantAnimation),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,engage),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isEngaged),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,disengage),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,timer),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,queue),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addRecast),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasRecast),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,resetRecast),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,resetRecasts),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, engage),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isEngaged),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, disengage),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, timer),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, queue),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addRecast),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasRecast),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, resetRecast),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, resetRecasts),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addListener),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,removeListener),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,triggerListener),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addListener),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, removeListener),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, triggerListener),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getEntity),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getNearbyEntities),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,canChangeState),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getEntity),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getNearbyEntities),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, canChangeState),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,wakeUp),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, wakeUp),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,recalculateStats),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,checkImbuedItems),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, recalculateStats),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, checkImbuedItems),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isDualWielding),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isDualWielding),
 
     // Enmity
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getCE),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getVE),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setCE),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setVE),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addEnmity),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,lowerEnmity),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,updateEnmity),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,transferEnmity),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,updateEnmityFromDamage),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,updateEnmityFromCure),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,resetEnmity),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,updateClaim),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getCE),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getVE),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setCE),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setVE),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addEnmity),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, lowerEnmity),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, updateEnmity),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, transferEnmity),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, updateEnmityFromDamage),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, updateEnmityFromCure),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, resetEnmity),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, updateClaim),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasEnmity),
 
     // Status Effects
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addStatusEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addStatusEffectEx),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getStatusEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getStatusEffects),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getStatusEffectElement),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,canGainStatusEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasStatusEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasStatusEffectByFlag),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,countEffect),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delStatusEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delStatusEffectsByFlag),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delStatusEffectSilent),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,eraseStatusEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,eraseAllStatusEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,dispelStatusEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,dispelAllStatusEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,stealStatusEffect),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addMod),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMod),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setMod),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delMod),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addLatent),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delLatent),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,fold),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,doWildCard),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addCorsairRoll),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasCorsairEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasBustEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,numBustEffects),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,healingWaltz),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addBardSong),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,charm),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,uncharm),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addBurden),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setStatDebilitation),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addStatusEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addStatusEffectEx),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getStatusEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getStatusEffects),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getStatusEffectElement),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, canGainStatusEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasStatusEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasStatusEffectByFlag),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, countEffect),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delStatusEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delStatusEffectsByFlag),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delStatusEffectSilent),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, eraseStatusEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, eraseAllStatusEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, dispelStatusEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, dispelAllStatusEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, stealStatusEffect),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addMod),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMod),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setMod),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delMod),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addLatent),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delLatent),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, fold),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, doWildCard),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addCorsairRoll),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasCorsairEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasBustEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, numBustEffects),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, healingWaltz),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addBardSong),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, charm),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, uncharm),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addBurden),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setStatDebilitation),
 
     // Damage Calculation
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getStat),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getACC),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getEVA),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getRACC),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getRATT),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getILvlMacc),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isSpellAoE),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,physicalDmgTaken),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,magicDmgTaken),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,rangedDmgTaken),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,breathDmgTaken),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,handleAfflatusMiseryDamage),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isWeaponTwoHanded),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMeleeHitDamage),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getWeaponDmg),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getWeaponDmgRank),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getOffhandDmg),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getOffhandDmgRank),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getRangedDmg),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getRangedDmgRank),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getAmmoDmg),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,removeAmmo),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getWeaponSkillLevel),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getWeaponDamageType),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getWeaponSkillType),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getWeaponSubSkillType),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getWSSkillchainProp),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,takeWeaponskillDamage),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,takeSpellDamage),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getStat),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getACC),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getEVA),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getRACC),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getRATT),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getILvlMacc),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isSpellAoE),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, physicalDmgTaken),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, magicDmgTaken),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, rangedDmgTaken),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, breathDmgTaken),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, handleAfflatusMiseryDamage),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isWeaponTwoHanded),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMeleeHitDamage),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getWeaponDmg),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getWeaponDmgRank),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getOffhandDmg),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getOffhandDmgRank),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getRangedDmg),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getRangedDmgRank),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getAmmoDmg),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, removeAmmo),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getWeaponSkillLevel),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getWeaponDamageType),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getWeaponSkillType),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getWeaponSubSkillType),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getWSSkillchainProp),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, takeWeaponskillDamage),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, takeSpellDamage),
 
     // Pets and Automations
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,spawnPet),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,despawnPet),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, spawnPet),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, despawnPet),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isJugPet),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasValidJugPetItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isJugPet),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasValidJugPetItem),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasPet),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getPet),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getPetID),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getPetElement),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMaster),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasPet),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPet),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPetID),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPetElement),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMaster),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getPetName),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setPetName),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPetName),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setPetName),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getCharmChance),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,charmPet),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getCharmChance),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, charmPet),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,petAttack),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,petAbility),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,petRetreat),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,familiar),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, petAttack),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, petAbility),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, petRetreat),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, familiar),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addPetMod),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setPetMod),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delPetMod),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addPetMod),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setPetMod),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delPetMod),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasAttachment),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getAutomatonName),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getAutomatonFrame),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getAutomatonHead),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,unlockAttachment),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasAttachment),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getAutomatonName),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getAutomatonFrame),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getAutomatonHead),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, unlockAttachment),
 
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getActiveManeuvers),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,removeOldestManeuver),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,removeAllManeuvers),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,updateAttachments),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getActiveManeuvers),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, removeOldestManeuver),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, removeAllManeuvers),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, updateAttachments),
 
+    // Trust related
     LUNAR_DECLARE_METHOD(CLuaBaseEntity, spawnTrust),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, clearTrusts),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getTrustID),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, trustPartyMessage),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addSimpleGambit),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addFullGambit),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setTPSkills),
 
     // Mob Entity-Specific
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setMobLevel),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getSystem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getFamily),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isMobType),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isUndead),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isNM),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getModelSize),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setMobFlags),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMobFlags),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,spawn),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,isSpawned),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getSpawnPos),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setSpawn),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getRespawnTime),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setRespawnTime),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,instantiateMob),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasTrait),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasImmunity),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setAggressive),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setTrueDetection),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setUnkillable),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,untargetable),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setDelay),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setDamage),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasSpellList),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setSpellList),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,SetAutoAttackEnabled),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,SetMagicCastingEnabled),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,SetMobAbilityEnabled),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,SetMobSkillAttack),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getMobMod),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setMobMod),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addMobMod),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,delMobMod),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getBattleTime),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getBehaviour),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setBehaviour),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getTarget),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,updateTarget),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getEnmityList),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getTrickAttackChar),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,actionQueueEmpty),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,castSpell),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,useJobAbility),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,useMobAbility),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasTPMoves),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,weaknessTrigger),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,hasPreventActionEffect),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,stun),
-
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getPool),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getDropID),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,setDropID),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,addTreasure),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getStealItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getDespoilItem),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getDespoilDebuff),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,itemStolen),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getTHlevel),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,getPlayerRegionInZone),
-    LUNAR_DECLARE_METHOD(CLuaBaseEntity,updateToEntireZone),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setMobLevel),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getSystem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getFamily),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isMobType),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isUndead),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isNM),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getModelSize),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setMobFlags),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMobFlags),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, spawn),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, isSpawned),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getSpawnPos),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setSpawn),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getRespawnTime),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setRespawnTime),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, instantiateMob),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasTrait),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasImmunity),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setAggressive),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setTrueDetection),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setUnkillable),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, untargetable),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setDelay),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setDamage),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasSpellList),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setSpellList),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, SetAutoAttackEnabled),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, SetMagicCastingEnabled),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, SetMobAbilityEnabled),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, SetMobSkillAttack),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getMobMod),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setMobMod),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addMobMod),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, delMobMod),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getBattleTime),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getBehaviour),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setBehaviour),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getTarget),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, updateTarget),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getEnmityList),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getTrickAttackChar),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, actionQueueEmpty),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, castSpell),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, useJobAbility),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, useMobAbility),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasTPMoves),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, weaknessTrigger),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, hasPreventActionEffect),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, stun),
+
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPool),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getDropID),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, setDropID),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, addTreasure),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getStealItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getDespoilItem),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getDespoilDebuff),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, itemStolen),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getTHlevel),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, getPlayerRegionInZone),
+    LUNAR_DECLARE_METHOD(CLuaBaseEntity, updateToEntireZone),
 
     {nullptr,nullptr}
 };